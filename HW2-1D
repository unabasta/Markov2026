gamma = 4;
x0 = 10;
Nvals = [100, 1000, 10000];

x_plot = linspace(0,60,500);
C = (gamma-1)*x0^(gamma-1);
pdf_theory = C*x_plot.^(-gamma);
pdf_theory(x_plot < x0) = 0;

figure
for k = 1:length(Nvals)
    N = Nvals(k);
    U = rand(N,1);
    X = x0*(1-U).^(-1/(gamma-1));

    subplot(1,3,k)
    histogram(X,'Normalization','pdf','BinLimits',[0 60])
    hold on
    plot(x_plot,pdf_theory,'r','LineWidth',2)
    xlabel('x')
    ylabel('PDF')
    title(['N = ',num2str(N)])
    xlim([0 60])
end
